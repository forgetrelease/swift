# Make a local copy of the substitutions.
config.substitutions = list(config.substitutions)

header_prefix = ''
arc_flag = ''
if 'objc_interop' in config.available_features:
  header_prefix = 'objective-'
  arc_flag = '-fobjc-arc '

config.substitutions.insert(0, ('%check-in-clang',
  '%%clang -fsyntax-only -x %sc-header %s-fmodules '
  '-fmodules-validate-system-headers '
  '-Weverything -Werror -Wno-unused-macros -Wno-incomplete-module '
  '-Wno-auto-import '
  '-F %%clang-importer-sdk-path/frameworks '
  '-I %%clang-include-dir '
  '-isysroot %r/Inputs/clang-importer-sdk' %
  (header_prefix, arc_flag, config.test_source_root) ) )

config.substitutions.insert(0, ('%check-in-clang-cxx',
  '%%clang -fsyntax-only -x %sc++-header -std=c++17 '
  '%s-fmodules -fmodules-validate-system-headers '
  '-Weverything -Werror -Wno-unused-macros -Wno-incomplete-module '
  '-Wno-auto-import -Wno-c++98-compat-pedantic '
  '-F %%clang-importer-sdk-path/frameworks '
  '-I %%clang-include-dir '
  '-isysroot %r/Inputs/clang-importer-sdk' %
  (header_prefix, arc_flag, config.test_source_root) ) )
